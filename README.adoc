// Copyright (c) 2024 IBM Corporation and others.
// Licensed under Creative Commons Attribution-NoDerivatives
// 4.0 International (CC BY-ND 4.0)
//   https://creativecommons.org/licenses/by-nd/4.0/
//
// Contributors:
//   IBM Corporation
:projectid: concurrency-intro
:page-layout: guide-multipane
:page-duration: 20 minutes
:page-releasedate: 2024-10-31
:page-description: Learn how to run tasks parallelly or asynchronously in Jakarta EE application by using JakartaConcurrency APIs.
:page-tags: ['jakartaee']
:page-permalink: /guides/{projectid}
:imagesdir: /img/guide/{projectid}
:page-related-guides: ['reactive-rest-client', 'microprofile-rest-client-async']
:common-includes: https://raw.githubusercontent.com/OpenLiberty/guides-common/prod
:source-highlighter: prettify
:page-seo-title: Running tasks parallelly or asynchronously in Jakarta EE application by using Jakarta ConcurrencyAPIs
:page-seo-description: A getting started tutorial with examples on how to run tasks parallelly or asynchronously in JakartaEE application by using Jakarta Concurrency APIs.
= Running tasks parallelly or asynchronously in Jakarta EE application

[.hidden]
NOTE: This repository contains the guide documentation source. To view the guide in published form, view it on the https://openliberty.io/guides/{projectid}.html[Open Liberty website].

Learn how to run tasks parallelly or asynchronously in Jakarta EE application by using JakartaConcurrency APIs.

== What you'll learn

Introduction
- explain Jakarta Concurrency APIs
- describe the application

Diagarm

image::architecture.png[Application architecture where inventory service uses the Jakarta Concurrency APIs to call the system service.,align="center"]


// =================================================================================================
// Getting started
// =================================================================================================
[role='command']
include::{common-includes}/gitclone.adoc[]

=== Try what you'll build

Polish the following instruction.

Navigate to the finish directory.
```
cd finish
```

Start `inventory` service in dev mode:
```
mvn -pl inventory liberty:run
```

Start `system` service in dev mode:
```
mvn -pl system liberty:run
```

Visit http://localhost:9080/openapi/ui for inventory REST APIs that perform asynchronous or parallel tasks

== Running tasks in parallel
Retrieve the system properties in parallel
- start the dev mode
- Replace the InventoryAsyncTask
  - Create a method that calls the system service in parallel to get different properties
  - Explain using the Managed Executor API to submit multiple tasks at once and sync by the Future.get API
- Replace the InventoryResource to 
  - Create the POST REST api to use the above method


== Creating asynchronous tasks

- Replace the InventoryAsyncTask
  - Create a method that calls all systems in the inventory asynchronously to get their memory usage
  - Explain @Asynchronous and using the Managed Executor API to submit asynchronous tasks
- Replace the InventoryResource to 
  - Create the /systems/memoryUsed PUT REST api to update the memory usage of all systems by using the above method


== Synchronizing asynchronous tasks
- Replace the InventoryAsyncTask
  - Create an asynchronous method that calls the system to get the system load
  - Explain @Asynchronous and returning CompletableFuture
- Replace the InventoryResource
  - Create the /systems/systemLoad PUT REST api to update the system load of all systems by using the above method


== Scheduling asynchronous task
This section will be available when Liberty supports concurrency-3.1 (now is in beta)

- Replace the InventoryAsyncTask
  - Create a scheduling method that updates the memory usage and system load of all systems in every 20 seconds


== Running the application

- similar to the https://openliberty.io/guides/cdi-intro.html#running-the-application

== Testing the inventory application

- similar to https://openliberty.io/guides/cdi-intro.html#testing-the-inventory-application
- explain the test

=== Running the tests

- similar to https://openliberty.io/guides/cdi-intro.html#running-the-tests
- stop the dev mode of the system and inventory services

== Great work! You're done!

You have just ... by using Jakarta Concurrency APIs in Open Liberty.

include::{common-includes}/attribution.adoc[subs="attributes"]
